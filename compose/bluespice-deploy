#!/bin/bash

source .env
EXTENDED_TOOLS=""


if [[ "${EDITION}" == "pro" || "${EDITION}" == "farm" ]]; then
	EXTENDED_TOOLS="${EXTENDED_TOOLS} -f docker-compose.collabpads-service.yml"
	REPO=bluespice/wiki:${VERSION}
else
	REPO=bluespice/wiki:${VERSION}
fi
if [ "${LETSENCRYPT}" == "true" ]; then
	EXTENDED_TOOLS="${EXTENDED_TOOLS} -f docker-compose.proxy-letsencrypt.yml"
fi
if [ "${KERBEROS}" == "true" ]; then
	EXTENDED_TOOLS="${EXTENDED_TOOLS} -f docker-compose.kerberos-proxy.yml"
fi
if [ "${EXPERIMENTAL}" == "true" ]; then
	EXTENDED_TOOLS="${EXTENDED_TOOLS} -f docker-compose.experimental.yml"
fi
	BLUESPICE_REPOSITORY=${REPO} \
		docker compose \
		-f docker-compose.main.yml \
		-f docker-compose.persistent-data-services.yml \
		-f docker-compose.stateless-services.yml \
		-f docker-compose.proxy.yml \
		${EXTENDED_TOOLS} \
		-f docker-compose.dev.yml \
		$@
